<!DOCTYPE html>
<html>
<head>
    <title>रील्स टूल</title>
    <style>
        /* ...existing CSS... */
        .error { color: red; }
    </style>
</head>
<body>
    <!-- ...existing HTML... -->

    <script>
        const { createFFmpeg } = FFmpeg;
        const ffmpeg = createFFmpeg({ 
            log: true,
            progress: ({ ratio }) => {
                const progress = Math.round(ratio * 100);
                document.getElementById('progressBar').style.width = `${progress}%`;
                document.getElementById('status').textContent = `प्रोसेसिंग: ${progress}%`;
            }
        });

        async function processVideo() {
            const file = document.getElementById('videoUpload').files[0];
            const processBtn = document.getElementById('processBtn');
            
            if(!file) {
                showError("कृपया वीडियो चुनें");
                return;
            }

            try {
                processBtn.disabled = true;
                document.getElementById('status').textContent = "FFmpeg लोड हो रहा है...";

                if(!ffmpeg.isLoaded()) await ffmpeg.load();

                document.getElementById('status').textContent = "वीडियो प्रोसेस हो रहा है...";
                ffmpeg.FS('writeFile', 'input.mp4', await fetchFile(file));
                
                await ffmpeg.run('-i', 'input.mp4', '-t', '30', 'output.mp4');
                
                const data = ffmpeg.FS('readFile', 'output.mp4');
                const url = URL.createObjectURL(new Blob([data.buffer], { type: 'video/mp4' }));
                document.getElementById('preview').src = url;
                document.getElementById('hashtags').innerHTML = "#viral #trending";

            } catch (error) {
                showError("त्रुटि: " + error.message);
                console.error(error);
            } finally {
                processBtn.disabled = false;
            }
        }

        function showError(message) {
            document.getElementById('status').textContent = message;
            document.getElementById('status').classList.add('error');
        }

        async function fetchFile(file) {
            try {
                return new Uint8Array(await file.arrayBuffer());
            } catch (error) {
                showError("फाइल पढ़ने में त्रुटि");
                throw error;
            }
        }
    </script>
</body>
</html>
